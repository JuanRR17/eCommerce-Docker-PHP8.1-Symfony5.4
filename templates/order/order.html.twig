{% extends 'base.html.twig' %}

{% block title %}Make Order{% endblock %}

{% block header %}Make Order{% endblock %}

{% block main %}
    {% if order is defined %}
    {# {{dump(order)}} #}
<div class="accordion" id="accordionPanelsStayOpenExample">
  <div class="accordion-item">
    <h2 class="accordion-header" id="panelsStayOpen-headingOne">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne">
        Order Items List
      </button>
    </h2>
    <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingOne">
      <div class="accordion-body">
      <table>
        <tr>
            <th>Image</th>
            <th>Product</th>
            <th>Price</th>
            <th>Quantity</th>
            <th>Total</th>
        </tr>
    
        {% for row in order.orderRows %}
        {% if row.product.images is not empty %}
        {% endif %}
        <tr>
            <td>{% if row.product.images is not empty %}<img class="img_basket" src="{{ asset('/assets/imgs/products/'~ row.product.id ~'/'~ row.product.images[0].name ) }}" />{% endif %}</td>
            <td><a href="{{path('productDetail', {'id': row.product.id})}}">{{ row.product.brand.name }} {{ row.product.model }}</a></td>
            <td class="align-right">{{ row.product.price }} €</td>
            <td>{{ row.quantity }}</td>
            <td class="align-right">{{ row.subtotal }} €</td>
        </tr>      
        {% endfor %}
            <tr> 
                <td></td>
                <td></td>
                <td></td>
                <td>Order Cost</td>
                <td class="align-right">{{ order.cost }} €</td>
            </tr>
        </table>

        <a href="{{ path('basket', {'id':app.user.id}) }}" class="btn btn-warning float-right m-2">Back to Basket</a>
        <div style="clear:both"></div>
      </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header" id="panelsStayOpen-headingTwo">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo">
        Delivery details
      </button>
    </h2>
    <div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingTwo">
      <div class="accordion-body">
        {{form_start(form)}}
        {{form_widget(form)}}
        {{form_end(form)}}
      </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header" id="panelsStayOpen-headingThree">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseThree" aria-expanded="false" aria-controls="panelsStayOpen-collapseThree">
        Payment details
      </button>
    </h2>
    <div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingThree">
      <div class="accordion-body">
      No need to pay anything for now. It's free!!
      </div>
    </div>
  </div>
</div>

<a href="#" class="btn btn-success float-right mt-2">Confirm Order</a>
        <div style="clear:both"></div>
    {% endif %}
{% endblock %}
