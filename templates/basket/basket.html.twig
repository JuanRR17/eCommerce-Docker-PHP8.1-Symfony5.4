{% extends 'base.html.twig' %}

{% block title %}Basket{% endblock %}

{% block header %}Basket{% endblock %}

{% block main %}
    {% if basket.basketRows.count > 0 %}
    <a href="{{ path('emptyBasket') }}" class="btn btn-danger">Empty Basket</a>
    <div class="overflow-auto my-3">
        <table class="table align-middle table-striped table-hover table-bordered border-secondary mb-0">
            <tr>
                <th colspan = "2" >Product</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Actions</th>
                <th>Total</th>
            </tr>
        
            {% for prod in basket.basketRows %}
            {% if prod.productId.images is not empty %}
            {% endif %}
            <tr>
                <td>{% if prod.productId.images is not empty %}<img class="img_basket" src="{{ asset('/assets/imgs/products/'~ prod.productId.id ~'/'~ prod.productId.images[0].name ) }}" />{% endif %}</td>
                <td>
                    <div class="productName">
                        <a href="{{path('productDetail', {'id': prod.productId.id})}}">{{ prod.productId.brand.name }} {{ prod.productId.model }}</a></td>
                    </div>
                <td class="align-right">{{ prod.productId.price|number_format(2, ',', '.') }} €</td>
                <td>{{ prod.quantity }}</br>
                {% if prod.quantity == prod.productId.stock %}
                    <span class="notAvailable">Max. Stock</span>
                {% endif %}</td>
                <td> 
                    <div
                     class="updown-units"
                     >
                        <a href="{{ path('basketUp', {'id':prod.id})}}">+</a>
                        <a href="{{ path('basketDown', {'id':prod.id})}}">-</a>
                        <a href="{{ path('removeRow', {'id':prod.id})}}">x</a>

                    </div>
                </td>
                <td class="align-right">{{ prod.subtotal|number_format(2, ',', '.') }} €</td>
            </tr>      
            {% endfor %}
                <tr class="rowTotal"> 
                    <td colspan = "4" ></td>
                    <td>Total in Basket</td>
                    <td class="align-right">{{ basket.total|number_format(2, ',', '.') }} €</td>
                </tr>
            </table>
        </div>
            <a href="{{ path('make_order', {'id': basket.id }) }}" class="btn btn-success float-right">Make Order</a>
    {% else %}
        Your basket is empty.
    {% endif %}
    
{% endblock %}
